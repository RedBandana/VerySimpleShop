<div class="shopping-cart">
  <div class="container">
    <h1 class="page-title">Shopping Cart</h1>

    @if(cartState?.error) {
    <div class="error">
      <div class="error-message">
        <h3>Error loading cart</h3>
        <p>{{ cartState?.error }}</p>
      </div>
    </div>
    }


    @if (cartItems.length == 0) {
    <div class="empty-cart">
      <div class="empty-cart-icon">ðŸ›’</div>
      <h2>Your cart is empty</h2>
      <p>Browse our products and add items to your cart</p>
      <a routerLink="/" class="continue-shopping-btn">Continue Shopping</a>
    </div>
    }
    @else {
    <div class="cart-content">
      <div class="cart-items">
        <h2>Cart Items</h2>

        <div class="cart-item">
          @for (item of cartItems; track item._id){
          <div class="item-image">
            <img [src]="item._product?.imageUrls?.[0] || '/assets/no-image.jpg'" [alt]="item._product?.name || 'Product'">
          </div>

          <div class="item-details">
            <h3 class="item-name">{{ item._product?.name }}</h3>
          </div>

          <div class="item-quantity">
            <button class="quantity-btn" (click)="removeFromCart(item)">-</button>
            <span class="quantity">{{ item.quantity }}</span>
            <button class="quantity-btn" (click)="addToCart(item)">+</button>
          </div>

          <div class="item-price">
            <span class="price">{{ getItemPriceString(item) }}</span>
          </div>

          <div class="item-actions">
            <button class="remove-btn" (click)="removeCartItem(item)">
              Remove
            </button>
          </div>
          }
        </div>

        <div class="cart-summary">
          <div class="summary-row">
            <span>Total:</span>
            <span class="total-price">{{ totalPriceString }}</span>
          </div>
        </div>

        <div class="cart-actions">
          <a routerLink="/" class="continue-shopping">Continue Shopping</a>
          <button class="checkout-btn" (click)="checkout()">
            Proceed to Checkout
          </button>
        </div>
      </div>
    </div>
    }
  </div>
</div>